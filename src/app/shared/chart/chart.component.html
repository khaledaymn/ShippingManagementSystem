<div class="chart-card-creative">
  <div class="chart-header">
    <h4>{{ chartData.title }}</h4>
    <div class="chart-stats" *ngIf="showStats">
      <div class="stat-item">
        <span class="stat-label">Average:</span>
        <span class="stat-value">{{ getAveragePerformance() }}%</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Best Month:</span>
        <span class="stat-value">{{ getBestMonth().month }} ({{ getBestMonth().value }}%)</span>
      </div>
    </div>
  </div>

  <div class="enhanced-chart" #chartContainer>
    <div *ngIf="chartData.type === 'line'" class="line-chart-enhanced">
      <svg class="line-chart-svg">
        <path
          class="chart-animated"
          [attr.d]="lineChartPathArea"
          fill="url(#chartGradient)"
          stroke="none"
          [ngClass]="{ 'chart-animated': chartAnimationComplete }"
        ></path>
        <path
          class="chart-animated"
          [attr.d]="lineChartPathLine"
          fill="none"
          stroke="#3b82f6"
          stroke-width="2"
          [ngClass]="{ 'chart-animated': chartAnimationComplete }"
        ></path>
        <g>
          <circle
            *ngFor="let point of animatedDataPoints; let i = index"
            class="data-point-enhanced"
            [ngClass]="{ 'data-point-hovered': hoveredDataPoint === i }"
            [attr.cx]="point.x"
            [attr.cy]="point.y"
            r="5"
            fill="#3b82f6"
            (mouseenter)="onDataPointHover(i)"
            (mouseleave)="onDataPointLeave()"
            [style.animationDelay]="point.delay + 'ms'"
          ></circle>
        </g>
        <defs>
          <linearGradient id="chartGradient" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color: #3b82f6; stop-opacity: 0.3" />
            <stop offset="100%" style="stop-color: #3b82f6; stop-opacity: 0" />
          </linearGradient>
        </defs>
      </svg>

      <div class="chart-labels-enhanced">
        <div *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]" class="chart-label-enhanced">
          <span class="month-number">{{ i }}</span>
          <span class="month-name">{{
            ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"][i - 1]
          }}</span>
        </div>
      </div>

      <div class="chart-values-enhanced">
        <div *ngFor="let i of [0, 20, 40, 60, 80, 100]" class="chart-value-enhanced">
          {{ i }}%
        </div>
      </div>

      <div
        *ngIf="hoveredDataPoint !== null"
        class="performance-tooltip"
        [style.left]="animatedDataPoints[hoveredDataPoint].x + 'px'"
        [style.top]="animatedDataPoints[hoveredDataPoint].y - 40 + 'px'"
      >
        <div class="tooltip-content">
          <span class="tooltip-month">Month {{ animatedDataPoints[hoveredDataPoint].month }}</span>
          <span class="tooltip-value">{{ animatedDataPoints[hoveredDataPoint].value }}%</span>
        </div>
      </div>
    </div>

    <div *ngIf="chartData.type === 'doughnut'" class="radial-chart-creative">
      <svg class="radial-chart-svg">
        <defs>
          <filter id="glow">
            <feGaussianBlur in="SourceGraphic" stdDeviation="2" result="blur" />
            <feMerge>
              <feMergeNode in="blur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>
        <circle
          *ngFor="let segment of radialSegments; let i = index"
          class="radial-segment"
          cx="150"
          cy="150"
          r="120"
          fill="none"
          [attr.stroke]="segment.color"
          stroke-width="30"
          [attr.stroke-dasharray]="segment.strokeDasharray"
          [attr.stroke-dashoffset]="segment.strokeDashoffset"
        ></circle>
      </svg>

      <div class="radial-center">
        <span class="center-value-creative">{{ getTotalValue() }}</span>
        <span class="center-label-creative">Total Orders</span>
      </div>
    </div>

    <div *ngIf="chartData.type === 'doughnut'" class="chart-legend-creative">
      <div *ngFor="let segment of radialSegments; let i = index" class="legend-item-creative">
        <span class="legend-indicator" [style.backgroundColor]="segment.color"></span>
        <span class="legend-text">{{ segment.label }}</span>
        <span class="legend-value">{{ chartData.data.values?.[i] }}</span>
      </div>
    </div>
  </div>
</div>
